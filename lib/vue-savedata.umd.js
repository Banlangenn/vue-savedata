!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function e(){return(e=Object.assign||function(e){for(var r=1;arguments.length>r;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}module.exports=function(r){var t=void 0===r?{}:r,o=t.SS,a=void 0===o?null:o,n=t.LS,i=void 0===n?null:n,l=t.saveName,s=void 0===l?"saveData":l,u=t.mode,f=void 0===u?"LS":u,c=t.ciphertext,d=void 0!==c&&c,y=t.encode,v=void 0===y?function(e){return window.btoa(encodeURIComponent(JSON.stringify(e)))}:y,S=t.decode,p=void 0===S?function(e){return JSON.parse(decodeURIComponent(window.atob(e)))}:S,m=t.setState,b=void 0===m?function(e,r){e=d?v(e):JSON.stringify(e),window[r].setItem(s,e)}:m,h=t.getState,g=void 0===h?function(e){try{var r=window[e].getItem(s);return r?d?p(r):JSON.parse(r):null}catch(e){return null}}:h,w=t.checkParams,O=void 0===w?function(e){return e.hasOwnProperty("storePath")&&e.hasOwnProperty("module")?!(!e.module.hasOwnProperty("state")||!e.module.hasOwnProperty("mutations"))||(console.warn("module约定必须要有mutations、state"),!1):(console.warn("SS,LS的key约定必须包含storePath、module"),!1)}:w;return function(r){var t,o=!a||Array.isArray(a)?a:[a],n=!i||Array.isArray(i)?i:[i],l=null,s=null;if(n){for(var u=Array.isArray(d=n),c=0,d=u?d:d[Symbol.iterator]();;){var y;if(u){if(c>=d.length)break;y=d[c++]}else{if((c=d.next()).done)break;y=c.value}if(!O(y)){n=null;break}}n&&(s=t=g("localStorage"))}if(o){for(var v=Array.isArray(p=o),S=0,p=v?p:p[Symbol.iterator]();;){var m;if(v){if(S>=p.length)break;m=p[S++]}else{if((S=p.next()).done)break;m=S.value}if(!O(m)){o=null;break}}o&&(l=g("sessionStorage"),t=t?e({},t,l):l)}n||o||(t=g("SS"!==f?"localStorage":"sessionStorage")),t&&r.replaceState(e({},r.state,t)),r.subscribe(function(r,t){if(n){for(var u=null,c=Array.isArray(y=n),d=0,y=c?y:y[Symbol.iterator]();;){var v;if(c){if(d>=y.length)break;v=y[d++]}else{if((d=y.next()).done)break;v=d.value}var S,p=v;Object.prototype.hasOwnProperty.call(p.module.mutations,r.type)&&(u=e({},u,((S={})[p.storePath]=t[p.storePath],S)))}if(u&&(s=e({},s,u),b(s,"localStorage")),!o)return}if(o){for(var m=null,h=Array.isArray(w=o),g=0,w=h?w:w[Symbol.iterator]();;){var O;if(h){if(g>=w.length)break;O=w[g++]}else{if((g=w.next()).done)break;O=g.value}var P,k=O;Object.prototype.hasOwnProperty.call(k.module.mutations,r.type)&&(m=e({},m,((P={})[k.storePath]=t[k.storePath],P)))}m&&(l=e({},l,m),b(l,"sessionStorage"))}else!i&&!a&&b(t,"SS"!==f?"localStorage":"sessionStorage")})}}});
