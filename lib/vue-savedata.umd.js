!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function e(){return(e=Object.assign||function(e){for(var r=1;arguments.length>r;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}module.exports=function(r){var t=void 0===r?{}:r,o=t.SS,a=void 0===o?null:o,n=t.LS,i=void 0===n?null:n,l=t.saveName,s=void 0===l?"saveData":l,u=t.mode,f=void 0===u?"LS":u,c=t.ciphertext,d=void 0!==c&&c,v=t.encode,y=void 0===v?function(e){return window.btoa(encodeURIComponent(JSON.stringify(e)))}:v,S=t.decode,p=void 0===S?function(e){return JSON.parse(decodeURIComponent(window.atob(e)))}:S,b=t.setState,h=void 0===b?function(e,r){e=d?y(e):JSON.stringify(e),window[r].setItem(s,e)}:b,m=t.getState,g=void 0===m?function(e){try{var r=window[e].getItem(s);return r?d?p(r):JSON.parse(r):null}catch(e){return null}}:m,w=t.checkParams,O=void 0===w?function(e){return!(!e.hasOwnProperty("storePath")||!e.hasOwnProperty("module"))||(console.warn("SS,LS的key约定必须包含storePath、module"),!1)}:w;return function(r){var t,o=!a||Array.isArray(a)?a:[a],n=!i||Array.isArray(i)?i:[i],l=null,s=null;if(n){for(var u=Array.isArray(d=n),c=0,d=u?d:d[Symbol.iterator]();;){var v;if(u){if(c>=d.length)break;v=d[c++]}else{if((c=d.next()).done)break;v=c.value}if(!O(v)){n=null;break}}n&&(s=t=g("localStorage"))}if(o){for(var y=Array.isArray(p=o),S=0,p=y?p:p[Symbol.iterator]();;){var b;if(y){if(S>=p.length)break;b=p[S++]}else{if((S=p.next()).done)break;b=S.value}if(!O(b)){o=null;break}}o&&(l=g("sessionStorage"),t=t?e({},t,l):l)}n||o||(t=g("SS"!==f?"localStorage":"sessionStorage")),t&&r.replaceState(e({},r.state,t)),r.subscribe(function(r,t){if(n){for(var u=null,c=Array.isArray(v=n),d=0,v=c?v:v[Symbol.iterator]();;){var y;if(c){if(d>=v.length)break;y=v[d++]}else{if((d=v.next()).done)break;y=d.value}var S,p=y;Object.prototype.hasOwnProperty.call(p.module.mutations,r.type)&&(u=e({},u,((S={})[p.storePath]=t[p.storePath],S)))}if(u&&(s=e({},s,u),h(s,"localStorage")),!o)return}if(o){for(var b=null,m=Array.isArray(w=o),g=0,w=m?w:w[Symbol.iterator]();;){var O;if(m){if(g>=w.length)break;O=w[g++]}else{if((g=w.next()).done)break;O=g.value}var k,A=O;Object.prototype.hasOwnProperty.call(A.module.mutations,r.type)&&(b=e({},b,((k={})[A.storePath]=t[A.storePath],k)))}b&&(l=e({},l,b),h(l,"sessionStorage"))}else!i&&!a&&h(t,"SS"!==f?"localStorage":"sessionStorage")})}}});
